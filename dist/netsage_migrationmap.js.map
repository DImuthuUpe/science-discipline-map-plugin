{"version":3,"sources":["netsage_migrationmap.js"],"names":["MetricsPanelCtrl","_","first","Scale","CustomHover","L","panelDefaults","num_lines","dark_map_url","light_map_url","center_lat","center_lon","zoom_lvl","dark_mode","showControls","animationPlaying","choices","array_option_1","array_option_2","array_option_3","array_option_4","parsed_data","max_total","DarkColorPallet","out_field_one","out_field_two","out_field_three","out_field_four","in_field_one","in_field_two","in_field_three","in_field_four","to_Byte","color","mode","cardColor","colorScale","exponent","colorScheme","fillBackground","legend","show","legend_colors","tooltip","showDefault","content","to_si","scales","rgb_values","hex_values","colorModes","custom_hover","migrationLayer","tempArray","datatoviz","LightColorPallet","table_data","endpoint_data","NetsageMigrationMap","$scope","$injector","defaults","panel","migrationmap_holder_id","id","containerDivId","scale","colorSchemes","getColorSchemes","events","on","onDataReceived","bind","onDataError","onInitEditMode","onInitPanelActions","setup","dataList","console","log","process_data","render","length","process_table","error","i","colorAr","value","volume","Math","round","tableData","filteredSet","endPointSet","forEach","datarows","element","rows","valIndex","sortedData","sort","a","b","filteredTopData","slice","el","source_name","dst_name","newObj","values","name","name2","push","found","filteredSetVal","filteredValtoPush","theone","find","e","getFixedColor","getRandomColor","j","obj","from","to","labels","valInBytes","srcResourceName","destResourceName","destResourceDisplayName","destDisplayName","err","dataRaw","addEditorTab","actions","num","index","splice","colors","displayColor","htmlContent","parseHtml","val","hrFormat","factor","k","m","g","t","p","toFixed","letters","floor","random","ctrl","offh","document","getElementById","offsetHeight","setTimeout","hasOwnProperty","destroy","innerHTML","map_url","container","DomUtil","get","_leaflet_id","map","minZoom","scrollWheelZoom","setView","tileLayer","addTo","play","setData","pause","data","pulseRadius","pulseBorderWidth","arcWidth","arcLabel","arcLabelFont","maxWidth","legendDivData","markerLocations","legendInfo","SrcMarkerInfo","placeName","latlong","DestMarkerInfo","legendDiv","filteredData","Array","Set","JSON","stringify","parse","lineToAdd","controlsDiv","playPauseBtn","checked","addEventListener","filteredMarkers","customPopup","customOptions","existsAsSource","filter","sourceValue","destValue","outGoingDiv","destName","valinGB","formattedValue","getFormattedValue","existsAsDest","incomingDiv","circle","circleMarker","weight","fillColor","fillOpacity","radius","log10","bindPopup","openPopup","scope","elem","attrs","slopegraph_holder_id","templateUrl"],"mappings":"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","file":"netsage_migrationmap.js","sourcesContent":["/*\n * (C) Mahesh Khanal, Laboratory for Advanced Visualization and Applications, University of Hawaii at Manoa.\n */\n\n\n/*\nCopyright 2018 The Trustees of Indiana University\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n\nimport { MetricsPanelCtrl } from 'app/plugins/sdk';\nimport _, { first } from 'lodash';\nimport { Scale } from './scale';\nimport { CustomHover } from './CustomHover';\nimport './css/migrationmap_styles.css!';\nimport L from './js/migrationmap_leaflet.js';\nimport './js/migrationmap_leaflet.migrationlayer.js';\n//import d3 from './js/migrationmap_d3.v3';\n\n////// place global variables here ////\nconst panelDefaults = {\n  num_lines: 10,\n  dark_map_url: \"https://api.tiles.mapbox.com/v4/mapbox.dark/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw\",\n  light_map_url: \"https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}{r}.png\",\n  center_lat: 15,\n  center_lon: 9,\n  zoom_lvl: 3,\n  dark_mode: false,\n  showControls: true,\n  animationPlaying: false,\n  choices: [],\n  array_option_1: [],\n  array_option_2: [],\n  array_option_3: [],\n  array_option_4: [],\n  parsed_data: [],\n  max_total: 0,\n  DarkColorPallet: [\"#EA3788\", \"#89FC00\", \"#01FDF6\", \"#C200FB\", \"#731DD8\", \"#CEB9DA\", \"#D6FF79\", \"#FF206E\", \"#F5B700\",\n    \"#00A1EA\", \"#8224E3\", \"#96F727\", \"#C04D9B\"\n  ],\n  //DarkColorPallet: [\"#0A369D\", \"#D53675\", \"#0B9290\", \"#FB1919\", \"#610DA7\", \"#F8A824\", \"#EA1AE0\", \"#531014\", \"#EF810B\", \"#4472CA\", \"#C1292E\", \"#356E46\", \"#D086F5\", \"#2CCB7A\", \"#6D5BDD\"],\n\n  //LightColorPallet: [\"#D53675\", \"#0B9290\", \"#FB1919\", \"#610DA7\", \"#F8A824\", \"#EA1AE0\", \"#531014\", \"#EF810B\", \"#4472CA\", \"#C1292E\", \"#356E46\", \"#D086F5\", \"#2CCB7A\", \"#6D5BDD\"],\n  //migrationLayer: {},\n\n\n  //table_data: [],\n  out_field_one: \"Discipline\",\n  out_field_two: \"To\",\n  out_field_three: \"Resource\",\n  out_field_four: \"Volume\",\n  in_field_one: \"Discipline\",\n  in_field_two: \"To\",\n  in_field_three: \"Resource\",\n  in_field_four: \"Volume\",\n  to_Byte: false,\n  color: {\n    mode: 'spectrum',\n    cardColor: '#b4ff00',\n    colorScale: 'linear',\n    exponent: 0.5,\n    colorScheme: 'interpolateOranges',\n    fillBackground: false\n  },\n  legend: {\n    show: true,\n    legend_colors: []\n  },\n  tooltip: {\n    show: true,\n    showDefault: true,\n    content: ' '\n  },\n  to_si: 1000000000,\n  scales: ['linear', 'sqrt'],\n  colorScheme: 'NetSage',\n  rgb_values: [],\n  hex_values: [],\n  //colorModes : ['opacity','spectrum'],\n  colorModes: ['spectrum'],\n  custom_hover: ' '\n};\n\nvar migrationLayer = {};\nvar tempArray = [];\nvar datatoviz = [];\nvar LightColorPallet = [\n  \"#4472CA\",\n  \"#0B9290\",\n  \"#610DA7\",\n  \"#D53675\",\n  \"#356E46\",\n  \"#531014\",\n  \"#C1292E\",\n  \"#D086F5\",\n  \"#2CCB7A\",\n  \"#6D5BDD\",\n  \"#0A369D\",\n  \"#F8A824\",\n  \"#EA1AE0\"];\nvar table_data = [];\nvar endpoint_data = [];\n\n\nexport class NetsageMigrationMap extends MetricsPanelCtrl {\n\n  constructor($scope, $injector) {\n    super($scope, $injector);\n\n    _.defaults(this.panel, panelDefaults);\n    this.migrationmap_holder_id = 'migrationmap_' + this.panel.id;\n    this.containerDivId = 'container_' + this.migrationmap_holder_id;\n    this.custom_hover = new CustomHover(this.panel.tooltip.content);\n    this.scale = new Scale(this.colorScheme);\n    this.colorSchemes = this.scale.getColorSchemes();\n    this.events.on('data-received', this.onDataReceived.bind(this));\n    this.events.on('data-error', this.onDataError.bind(this));\n    this.events.on('data-snapshot-load', this.onDataReceived.bind(this));\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    this.events.on('init-panel-actions', this.onInitPanelActions.bind(this));\n\n    this.events.on('render', this.setup.bind(this));\n    this.events.on('refresh', this.setup.bind(this));\n  }\n\n\n\n  onDataReceived(dataList) {\n    console.log(\"Raw data\");\n    console.log(dataList);\n    this.panel.parsed_data = [];\n    this.panel.max_total = 0;\n    this.process_data(dataList);\n    this.render();\n  }\n\n\n\n  process_data(dataList) {\n    table_data = [];\n    endpoint_data = [];\n    if (dataList.length != 0) {\n      try {\n        this.process_table(dataList);\n      } catch (error) {\n        console.error(\"ERROR PARSING DATA. PLEASE MAKE SURE THE DATA IS SET PROPERLY\");\n      }\n\n    }\n  }\n\n  getFixedColor(i) {\n    var colorAr = [];\n\n    //  if (this.panel.dark_mode) {\n    //colorAr = this.panel.DarkColorPallet;\n    //  } else {\n    colorAr = LightColorPallet;\n    // }\n\n    return colorAr[i];\n  }\n\n\n  getFormattedValue(value) {\n    value = value / 1000;\n    var volume = value;\n    if (value < 1000) {\n      volume = (Math.round(value * 10) / 10) + \" KB\";\n    } else {\n      value = value / 1000;\n      if (value < 1000) {\n        volume = (Math.round(value * 10) / 10) + \" MB\"\n      } else {\n        value = value / 1000;\n        if (value < 1000) {\n          volume = (Math.round(value * 10) / 10) + \" GB\"\n        } else {\n          value = value / 1000;\n          if (value < 1000) {\n            volume = (Math.round(value * 10) / 10) + \" TB\"\n          } else {\n            volume = (Math.round(value * 10) / 10) + \" PB\"\n          }\n        }\n      }\n    }\n    return volume;\n  }\n\n  process_table(tableData) {\n\n    var filteredSet = [];\n    var endPointSet = [];\n    var num_lines = this.panel.num_lines;\n\n    tableData.forEach(element => {\n      var datarows = element.rows;\n\n      var valIndex = datarows[0].length - 1;\n      var sortedData = datarows.sort(function (a, b) { return b[valIndex] - a[valIndex] });\n      console.log(\"sorted:\");\n      console.log(sortedData);\n\n      if (sortedData.length > num_lines) {\n        var filteredTopData = sortedData.slice(0, num_lines);\n      } else {\n        filteredTopData = sortedData;\n      }\n\n      var first = true;\n      // for legend\n      filteredTopData.forEach(function (el) {\n        if (true) {\n          if (first) {\n            first = false;\n            console.log('filtered element');\n            console.log(el);\n          }\n\n          var source_name = el[0];\n          var dst_name = el[1];\n\n          var newObj = {};\n          newObj.values = [];\n          newObj.name = source_name;\n          newObj.name2 = dst_name;\n          newObj.values.push(el);\n\n          var found = false;\n          var filteredSetVal = 0;\n          var filteredValtoPush = [];\n\n          for (var i = 0; i < filteredSet.length; i++) {\n            if ((filteredSet[i].name == source_name) && (filteredSet[i].name2 == dst_name)) {\n              found = true;\n              filteredSetVal = i;\n\n\n            }\n          }\n          if (!found) {\n            filteredSet.push(newObj);\n          } else {\n            var theone = filteredSet.find(function (e) {\n              return ((e.name == source_name) && (e.name2 == dst_name));\n              console.log(\"reached here and did nothing\");\n            })\n            filteredSet[filteredSetVal].values.push(el);\n          }\n\n        }\n\n      })\n\n    });\n    //need to fix filtered set because the endpoints are also added. \n    console.log('filteredSet');\n    console.log(filteredSet);\n    for (var i = 0; i < filteredSet.length; i++) {\n      //need to get color for each source \n      var color = this.getFixedColor(i) || this.getRandomColor();\n\n      // console.log(filteredSet[i]);\n      for (var j = 0; j < filteredSet[i].values.length; j++) {\n\n\n        var element = filteredSet[i].values[j];\n        if (element.length > 10) {\n          var obj = {};\n          obj.name = element[0];\n          obj.name2 = element[1]; // add\n          obj.from = [element[5], element[4]]; // coordinates\n          obj.to = [element[9], element[8]]; // coordinates\n          obj.labels = [element[2], element[6]];\n          obj.color = color;\n          obj.value = 1;\n          obj.valInBytes = element[10];\n          obj.srcResourceName = element[3];\n          obj.destResourceName = element[7];\n          obj.destResourceDisplayName = element[7];\n          obj.destDisplayName = element[6];\n\n          table_data.push(obj);\n        } else if (element.length == 10) {\n          var obj = {};\n          obj.name = element[0];\n          obj.name2 = '';\n          obj.from = [element[4], element[3]];\n          obj.to = [element[8], element[7]];\n          obj.labels = [element[1], element[5]];\n          obj.color = color;\n          obj.value = 1;\n          obj.valInBytes = element[9];\n          obj.srcResourceName = element[2];\n          obj.destResourceName = element[6];\n          obj.destResourceDisplayName = element[6];\n          obj.destDisplayName = element[5];\n\n          console.log(\"Color is \" + color + \" with index \" + i);\n          table_data.push(obj);\n        } else {\n          var obj = {};\n          obj.name = element[0];\n          obj.from = [element[3], element[2]];\n          obj.to = [element[3], element[2]];\n          obj.labels = [element[1], element[1]];\n          obj.color = color;\n          obj.value = 1;\n          obj.valInBytes = element[5];\n          obj.srcResourceName = element[4];\n          obj.destResourceName = element[4];\n          obj.destResourceDisplayName = \"UNKNOWN\";\n          obj.destDisplayName = \"UNKNOWN\";\n\n          console.log(\"Color is \" + color + \" with index \" + i);\n          table_data.push(obj);\n\n\n        }\n\n\n\n\n      }\n\n\n    }\n\n\n  }\n\n\n\n  onDataError(err) {\n    this.dataRaw = [];\n  }\n\n\n\n  onInitEditMode() {\n    this.addEditorTab('Options', 'public/plugins/netsage-migrationmap/editor.html', 2);\n    this.render();\n  }\n\n\n\n  onInitPanelActions(actions) {\n    this.render();\n  }\n\n\n  addNewChoice() {\n    var num = this.panel.choices.length + 1;\n    this.panel.choices.push(num);\n    this.panel.array_option_1.push('');\n    this.panel.array_option_2.push('');\n    this.panel.array_option_3.push('');\n    this.panel.array_option_4.push('');\n  }\n\n\n  removeChoice(index) {\n    this.panel.choices.splice(index, 1);\n    this.panel.array_option_1.splice(index, 1);\n    this.panel.array_option_2.splice(index, 1);\n    this.panel.array_option_3.splice(index, 1);\n    this.panel.array_option_4.splice(index, 1);\n  }\n\n\n  display() {\n    this.panel.colors = this.scale.displayColor(this.panel.colorScheme);\n    this.panel.rgb_values = this.panel.colors.rgb_values;\n    this.panel.hex_values = this.panel.colors.hex_values;\n  }\n\n\n\n  getHtml(htmlContent) {\n    return this.custom_hover.parseHtml(htmlContent);\n    ///use in link///\n    //             let html_content = ctrl.getHtml(ctrl.panel.tooltip.content);\n    //             ctrl.panel.tooltip.content = html_content;\n  }\n\n  formatBytes(val) {\n    var hrFormat = null;\n    var factor = 1024.0\n    val = val / 8.0;\n\n    var b = val;\n    var k = val / factor;\n    var m = ((val / factor) / factor);\n    var g = (((val / factor) / factor) / factor);\n    var t = ((((val / factor) / factor) / factor) / factor);\n    var p = (((((val / factor) / factor) / factor) / factor) / factor);\n\n    if (p > 1) {\n      hrFormat = p.toFixed(2) + \"(PB)\";\n    } else if (t > 1) {\n      hrFormat = t.toFixed(2) + \"(TB)\";\n    } else if (g > 1) {\n      hrFormat = g.toFixed(2) + \"(GB)\";\n    } else if (m > 1) {\n      hrFormat = m.toFixed(2) + \"(MB)\";\n    } else if (k > 1) {\n      hrFormat = k.toFixed(2) + \"(KB)\";\n    } else {\n      hrFormat = b.toFixed(2) + \"(Bytes)\";\n    }\n\n    return hrFormat\n  }\n\n  formatBits(val) {\n    var hrFormat = null;\n    var factor = 1024.0\n\n    var b = val;\n    var k = val / factor;\n    var m = ((val / factor) / factor);\n    var g = (((val / factor) / factor) / factor);\n    var t = ((((val / factor) / factor) / factor) / factor);\n    var p = (((((val / factor) / factor) / factor) / factor) / factor);\n\n    if (p > 1) {\n      hrFormat = p.toFixed(2) + \"(Pb)\";\n    } else if (t > 1) {\n      hrFormat = t.toFixed(2) + \"(Tb)\";\n    } else if (g > 1) {\n      hrFormat = g.toFixed(2) + \"(Gb)\";\n    } else if (m > 1) {\n      hrFormat = m.toFixed(2) + \"(Mb)\";\n    } else if (k > 1) {\n      hrFormat = k.toFixed(2) + \"(Kb)\";\n    } else {\n      hrFormat = b.toFixed(2) + \"(bits)\";\n    }\n\n    return hrFormat\n  }\n\n  getRandomColor() {\n    var letters = '0123456789ABCDEF';\n    var color = '#';\n    for (var i = 0; i < 6; i++) {\n      color += letters[Math.floor(Math.random() * 16)];\n    }\n    return color;\n  }\n\n\n  setup() {\n    if (!table_data) {\n      return;\n    }\n\n    /*\n    This is the fix for map not rendering completely. \n    */\n    var ctrl = this;\n    var offh = 450;\n    if (document.getElementById(this.migrationmap_holder_id)) {\n      offh = document.getElementById(this.migrationmap_holder_id).offsetHeight;\n    }\n    if (offh == 0) {\n      return setTimeout(function () { ctrl.setup(); }, 250);\n    }\n\n\n    if (migrationLayer) {\n      if (migrationLayer.hasOwnProperty(\"canvas\")) {\n        if (typeof migrationLayer.destroy === 'function') {\n          try {\n            migrationLayer.destroy();\n          } catch (error) {\n            console.error(\"ERROR WHILE DESTROYING MIGRATION LAYER!!\");\n          }\n\n        }\n      }\n    }\n\n\n    if (document.getElementById(ctrl.migrationmap_holder_id)) {\n\n      document.getElementById(ctrl.containerDivId).innerHTML = '<div id=\"map\"><div id = \"legend\" >LEGEND </br> </div></div>';\n\n\n\n      var map_url = \"\";\n\n      if (this.panel.dark_mode) {\n        //console.log(\"Dark Loaded\");\n        map_url = ctrl.panel.dark_map_url;\n      } else {\n        map_url = ctrl.panel.light_map_url;\n        // console.log(\"Light loaded\");\n      }\n\n\n\n      var id = document.getElementById(\"map\");\n      // var id = document.getElementById(ctrl.migrationmap_holder_id);\n      if (id) {\n\n        try {\n          var container = L.DomUtil.get('map'); if (container != null) { container._leaflet_id = null; }\n\n          var map = L.map('map', {\n            minZoom: 2,\n            scrollWheelZoom: false,\n            // maxBounds:bounds\n          }).setView([ctrl.panel.center_lat || 35, ctrl.panel.center_lon || -95], ctrl.panel.zoom_lvl || 5);\n          L.tileLayer(map_url || \"https://api.tiles.mapbox.com/v4/mapbox.dark/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw\")\n            .addTo(map);\n\n          map.on('zoomend', () => {\n\n            if (!ctrl.panel.animationPlaying) {\n              migrationLayer.play();\n              migrationLayer.setData(table_data);\n              migrationLayer.pause();\n            } else {\n              migrationLayer.setData(table_data);\n            }\n\n          });\n\n\n          map.on('dragend', function () {\n            //turn off auto-fit\n            if (!ctrl.panel.animationPlaying) {\n              migrationLayer.play();\n              migrationLayer.setData(table_data);\n              migrationLayer.pause();\n            } else {\n              migrationLayer.setData(table_data);\n            }\n          })\n\n          // map.setMaxBounds(map.getBounds()); \n\n        } catch (error) {\n          console.log(\"MAP INITIALIZATION FAILED.\");\n        }\n\n\n\n\n        migrationLayer = new L.migrationLayer({\n          map: map,\n          data: [],\n          pulseRadius: 0,\n          pulseBorderWidth: 0,\n          arcWidth: 0.5,\n          arcLabel: false,\n          arcLabelFont: '10px sans-serif',\n          maxWidth: 5\n        });\n\n\n        migrationLayer.addTo(map);\n\n\n        if (ctrl.panel.animationPlaying) {\n          migrationLayer.play();\n        }\n        if (!ctrl.panel.animationPlaying) {\n          setTimeout(() => {\n            migrationLayer.pause();\n          }, 3000);\n\n        }\n\n        migrationLayer.setData(table_data);\n\n\n\n\n\n\n      }\n\n\n\n\n\n      //Create legend \n\n      var legendDivData = [];\n      var markerLocations = [];\n\n\n\n\n      table_data.forEach(element => {\n\n        //var customPopup = \"<h2 class = 'custom' style = 'color:\" + element.color + \"'> Discipline : \" + element.name + \" </h2></br><h3>Source : \" + element.labels[0] + \"</h2><br/><h3>Destination : \" + element.labels[1] + \" </h2></br><h3 class = 'custom'> Value : \" + element.valInBytes + \" Bytes </h3>\"\n        //var customPopup2 = \"<h2 class = 'custom' style = 'color:\" + element.color + \"'> Discipline : \" + element.name + \" </h2></br><h3>Source : \" + element.labels[0] + \"</h2><br/><h3>Destination : \" + element.labels[1] + \" </h2></br><h3 class = 'custom'> Value : \" + element.valInBytes + \" Bytes </h3>\"\n\n        var legendInfo = { name: element.name, name2: element.name2, color: element.color }\n        legendDivData.push(legendInfo);\n        var SrcMarkerInfo = { placeName: element.labels[0], latlong: [element.from[1], element.from[0]] };\n        var DestMarkerInfo = { placeName: element.labels[1], latlong: [element.to[1], element.to[0]] };\n        markerLocations.push(SrcMarkerInfo);\n        markerLocations.push(DestMarkerInfo);\n      });\n\n\n\n      var legendDiv = document.getElementById(\"legend\");\n\n      var filteredData = Array.from(new Set(legendDivData.map(JSON.stringify))).map(JSON.parse);\n      filteredData.forEach(element => {\n        var lineToAdd = '<span class = \"legendItem\" style= \"color: ' + element.color + ';\">' + element.name + ' - ' + element.name2 + '</span></br>';\n        legendDiv.innerHTML += lineToAdd;\n      });\n\n      legendDiv.innerHTML += '<div id=\"controls\"></div>';\n      let controlsDiv = document.getElementById(\"controls\");\n      if (ctrl.panel.showControls) {\n        controlsDiv.innerHTML = '<br/><span>ANIMATIONS</span><br/>';\n        controlsDiv.innerHTML += '<label class=\"switch\"><input type=\"checkbox\" id=\"playPause\"><span class=\"slider round\"></span></label>'\n      }\n\n      let playPauseBtn = document.getElementById(\"playPause\");\n\n\n      if (playPauseBtn) {\n\n        playPauseBtn.checked = ctrl.panel.animationPlaying;\n        playPauseBtn.addEventListener(\"change\", function () {\n          if (playPauseBtn.checked) {\n            ctrl.panel.animationPlaying = true;\n            migrationLayer.play();\n          } else {\n            ctrl.panel.animationPlaying = false;\n            migrationLayer.pause();\n          }\n        })\n      }\n\n\n\n\n\n      //Markers \n      var filteredMarkers = Array.from(new Set(markerLocations.map(JSON.stringify))).map(JSON.parse);\n      //console.log(filteredMarkers);\n      filteredMarkers.forEach(element => {\n        var customPopup = \"<h3 class='orgName'>\" + element.placeName + \"</h3>\";\n        var customOptions =\n        {\n          'maxWidth': '310',\n          'maxHeight': '200',\n          'className': 'customPopUp',\n          'overflow-y': 'scroll',\n          'border-bottom': '0px',\n          'border-top': '0px'\n        }\n\n        var data = table_data;\n\n        //var filteredSource = data.filter(({ labels }) => labels[0] === element.placeName);\n        //var existsAsSource = data.filter(({ srcResourceName }) => srcResourceName === element.resourceName);\n        var existsAsSource = data.filter(({ from }) => from[0] === element.latlong[1] && from[1] === element.latlong[0]);\n        // var existsAsSource = Array.from(new Set(filteredSource.map(JSON.stringify))).map(JSON.parse);\n\n\n\n        var sourceValue = 0.0;\n        var destValue = 0.0;\n\n        if (existsAsSource.length > 0) {\n          //console.log(existsAsSource);\n          var outGoingDiv = \"<h5><u>Outgoing </u></h5>\";\n          for (var i = 0; i < existsAsSource.length; i++) {\n            if (existsAsSource[i]) {\n              var destName = \"\";\n              var valinGB = existsAsSource[i].valInBytes / 8589934592;\n              sourceValue += valinGB;\n              valinGB = valinGB.toFixed(3);\n              var formattedValue = this.getFormattedValue(existsAsSource[i].valInBytes);\n              //outGoingDiv += \"<span style = 'color: \" + existsAsSource[i].color + \"'> Discipline : \" + existsAsSource[i].name + \"  </br> To : \" + existsAsSource[i].labels[1] + \" </br> Value : \" + valinGB + \" GB</span></br></br>\"\n              outGoingDiv += \"<span style = 'color: \" + existsAsSource[i].color + \"'> \" + ctrl.panel.out_field_one + \": \" + existsAsSource[i].name + \"  </br> \" + ctrl.panel.out_field_two + \": \" + existsAsSource[i].destDisplayName + \"</br>\" + ctrl.panel.out_field_three + \": \" + existsAsSource[i].destResourceDisplayName + \" </br>\" + ctrl.panel.out_field_four + \": \" + formattedValue + \"</span></br></br>\"\n\n            }\n\n          }\n          customPopup += outGoingDiv;\n\n        }\n\n        //var filteredDest = data.filter(({ labels }) => labels[1] === element.placeName);\n        var existsAsDest = data.filter(({ to }) => to[0] === element.latlong[1] && to[1] === element.latlong[0]);\n        //var existsAsDest = data.filter(({ destResourceName }) => destResourceName === element.resourceName);\n        // var existsAsDest = Array.from(new Set(filteredDest.map(JSON.stringify))).map(JSON.parse);\n\n        if (existsAsDest.length > 0) {\n          var incomingDiv = \"<h5><u>Incoming</u> </h5>\";\n\n          for (var i = 0; i < existsAsDest.length; i++) {\n            if (existsAsDest[i]) {\n              //need to check if its endpoint\n              if (existsAsDest[i].labels[0] === existsAsDest[i].labels[1]) {\n                //do nothing\n              } else {\n                var valinGB = existsAsDest[i].valInBytes / 8589934592;\n                destValue += valinGB;\n                valinGB = valinGB.toFixed(3);\n                var formattedValue = this.getFormattedValue(existsAsDest[i].valInBytes);\n\n                //incomingDiv += \"<span style = 'color: \" + existsAsDest[i].color + \"'> Discipline : \" + existsAsDest[i].name + \"  </br> From : \" + existsAsDest[i].labels[0] + \"</br>Value : \" + valinGB + \" GB</span></br></br>\"\n                incomingDiv += \"<span style = 'color: \" + existsAsDest[i].color + \"'>\" + ctrl.panel.in_field_one + \": \" + existsAsDest[i].name + \"  </br>\" + ctrl.panel.in_field_two + \": \" + existsAsDest[i].labels[0] + \"</br>\" + ctrl.panel.in_field_three + \": \" + existsAsDest[i].srcResourceName + \"</br>\" + ctrl.panel.in_field_four + \": \" + formattedValue + \"</span></br></br>\"\n              }\n\n            }\n\n          }\n          customPopup += incomingDiv;\n\n\n        }\n\n        var circle = L.circleMarker([element.latlong[0], element.latlong[1]], {\n          color: \"black\",\n          weight: 0.6,\n          fillColor: \"rgba(255,165,0,0.9)\",\n          fillOpacity: 0.9,\n          // radius: 5 + existsAsSource.length + existsAsDest.length\n          radius: 5 + Math.log10(sourceValue + destValue) * 2\n        }).addTo(map);\n        circle.bindPopup(customPopup, customOptions);\n        circle.on('mouseover', function (e) {\n          this.openPopup();\n        });\n        circle.on('mouseout', function (e) {\n          // this.closePopup();\n        });\n      });\n\n    }\n\n  }\n\n  link(scope, elem, attrs, ctrl) {\n    if (!document.getElementById(ctrl.slopegraph_holder_id)) {\n      return;\n    }\n    this.render();\n  }\n\n}\n\nNetsageMigrationMap.templateUrl = 'module.html';\n"]}